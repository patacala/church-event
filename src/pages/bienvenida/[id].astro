---
import Layout from '../../layouts/Layout.astro';
import GafeteDigital from '../../components/GafeteDigital';
import { getAsistente } from '../../lib/supabase';

// Obtener el ID del asistente desde los par√°metros de la URL
const { id } = Astro.params;

if (!id) {
  return Astro.redirect('/');
}

// Obtener datos del asistente desde Supabase
const asistente = await getAsistente(id);

// Si no existe el asistente, redirigir a home
if (!asistente) {
  return Astro.redirect('/');
}

const pageTitle = `${asistente.nombre} - The Victory Church`;
const pageDescription = `Gafete digital de ${asistente.nombre} para el evento de The Victory Church`;
---

<Layout title={pageTitle} description={pageDescription}>
  <main>
    <GafeteDigital asistente={asistente} client:load />
  </main>
</Layout>
